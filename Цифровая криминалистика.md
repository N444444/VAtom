К компьютеру на котором будет проводится экспертиза нет требований усыновлённых ФСТЭК или законодательством. 

## Софт
Коммерческий: Paraben c продуктом E3:Universal Software, EnCase Forensic, AccessData c продуктом Forensic Toolkit, Belkasoft с продуктом Belkasoft Evidence Center и другие.

## Порядок проведения анализа
### Клонирование диска
В целях обеспечения целостности и неизменяемости информации, требуется сделать побитовую резервную копию исследуемой системы, так как:
-  ОС постоянно индексируют файлы, меняя атрибут "дата последнего доступа" (в основном в Windows).
- Антивирусы норовят почистить файлы от вредоносного кода, внеся изменения в объект исследования.
	
Блокирование записи файлов[]([https://habr.com/ru/company/bizone/blog/320032/](https://habr.com/ru/company/bizone/blog/320032/)) осуществляется при помощи ПО или с помощью аппаратного блокиратора.
#### В Windows
Программа для побитного клонирования - **[Access Data FTK Imager]([https://accessdata.com/product-download](https://accessdata.com/product-download))**. Ещё может смотреть содержимое образа и подключать его как носитель. 
#### В Linux 
Использовать команду:
```
	dd if=/dev/sda of=/home/username/image.dd
```

Команда скопирует содержимое диска `/sda` в файл `/image.dd`. Её следует использовать аккуратно, неправильное использование может привести к удалению данных.
#### Отдельно загружаемая
[OSForensics]([https://www.osforensics.com/tools/create-disk-images.html](https://www.osforensics.com/tools/create-disk-images.html))

---

### Клонирование оперативной памяти
Часть следов может скрываться в оперативной памяти. Для снятия образа оперативной памяти нужен диск большего объёма чем оперативная память. 
#### В Windows
Многие программы используются активные системы противодействия отладке, способные обнаружить и предотвратить попытку других программ считать данные из защищённых областей памяти. Обойти активные виды защиты от отладки способны только инструменты, запущенные в привилегированном режиме ядра операционной системы. В поставку [Belkasoft RAM Capturer]([https://belkasoft.com/ru/ram-capturer](https://belkasoft.com/ru/ram-capturer)) входят 32- и 64-разрядные версии драйверов, работающих в режиме ядра и позволяя обрабатывать области данных, принадлежащие защищённым процессам. Программа не требует установки и может быть запущена с внешнего флеш-накопителя. 

Аналог - Access Data FTK Imager. При её использовании в дамп памяти опционально может быть включён файл pagefile.sys, являющийся файлом подкачки операционной системы семейства Windows.
#### В Linux
Используется инструмент -  LiME - Linux Memory Extractor. Позволяет захватавать содержимое оперативной памяти Linux-based устройств и смартфонов Android.

Подробное описание всех команд и настроек программы LiME можно посмотреть здесь: [https://github.com/504ensicsLabs/LiME](https://github.com/504ensicsLabs/LiME)

---

### Работа с дампами памяти
[Volatility Workbench]([https://www.osforensics.com/tools/volatility-workbench.html](https://www.osforensics.com/tools/volatility-workbench.html)). Поддержка дампов памяти Windows, Linux и Mac.

---

### Анализ файловой структуры носителя
В ручном режиме - Access Data FTK Imager.
В автоматическом режиме - [Autopsy]([https://www.autopsy.com/](https://www.autopsy.com/)) (магнитные носители и телефоны).

Autopsy формирует историю изменений. Также извлекает историю собщений, e-mail адреса, данные банковских карт, видео и фото изображения, а также метаданные цифровых файлов.

Одно из доступных расширений - VirusTotal Online Checker во время анализа содержимого образа позволяет загружать файлы на VirusTotal и проверять их на наличие вирусов.

---

### Анализ реестра Windows
Файлы реестра операционной системы Windows размещены в каталоге `C:\Windows\System32\config\` и к ним относятся файлы: 
- SAM, 
- SOFTWARE, 
- SECURITY, 
- SYSTEM.
Проанализировать их поможет - [MiTeC Windows]([https://www.mitec.cz/wrr.html](https://www.mitec.cz/wrr.html)).
Она может просматривать информацию о зарегистрированных в системе пользователях и их отношениях к группам, список установленного программного обеспечения, приложения автозапуска, переменные среды, параметры Windows Firewall, сервисы и драйверы, установленные в системе.

---

### Исследование логов
Windows хранит логи событий в каталоге C:\WINDOWS\system32\config\. Логи Linux хранятся в каталоге /var/log/.

Некоторые приложения в Windows при установке с правами администратора хранят логи в соответствующем каталоге C:\Program Files\, эти же приложения при установке без прав администратора предпочитают каталог Application Data. В Windows XP этот каталог расположен по адресу C:\Documents and Settings\<user name>\Application Data\ в Windows 7 и выше по адресу C:\Users\<user name>\AppData\. Вместе с тем, никто не мешает приложениям хранить логи ещё в каких-то папках на диске.

В любом случае, при анализе активности какого-то конкретного приложения необходимо обратиться к его документации для определения месторасположения лог-файлов, в этом часто помогает Google.